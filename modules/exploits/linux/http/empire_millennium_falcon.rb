class MetasploitModule < Msf::Exploit::Remote
	Rank = nil

	# TODO get hash where vunerability was fixed
	# TODO create test docker container of empire 
	# TODO payload, targets, platform
	# Break POC down into small steps, mostly concerned with foregry of stages first

	def initialize(info={})
		'Name' => 'PowerShellEmpire Arbitrary file Upload (Millennium Falcon)',

		'Description' => %q{This module exploits a vulnerability in PowerShellEmpire < 5.9.3 
			which allows for RCE via arbitary file uploads. This module will upload a file to the cron.d 
			directory to spawn a reverse shell. Thank you to AceResponder for the discovery of 
			this vunerability and original POC; and of course thank you to h00die for the module suggestion },

			'Author' => [
				'Ace Responder', # Original exploit discovery and POC
				'gardnerapp' # Metasploit module
			], 
			'License' => MSF_LICENSE,
			'References' => [] # TODO link Ace Responder writeup and POC 

			register_options(
				[
					Opt::RPORT(8080),
					OptString.new('TARGETURI', [false, 'Base URI path', '/'])
				])
	end 
end 